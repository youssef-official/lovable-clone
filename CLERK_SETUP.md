# شرح إعدادات Clerk للأدوار والاشتراكات

مرحباً بك! هذا الملف يشرح لك كيفية إدارة صلاحيات المستخدمين، وتحديداً كيفية منح مستخدم معين صلاحيات "الخطة الاحترافية" (Pro Plan) في موقعك، وذلك باستخدام لوحة تحكم Clerk.

## كيف يعمل النظام؟

نظام التحقق من الاشتراكات في موقعك يعتمد على نظام الأذونات (Permissions) في Clerk. الكود البرمجي يتحقق مما إذا كان لدى المستخدم الحالي إذن يسمى `pro`. إذا كان لديه هذا الإذن، فإنه يعتبر مشتركًا في الخطة الاحترافية ويحصل على الميزات الخاصة بها.

السطر المسؤول عن هذا التحقق في الكود هو:
`const hasProAccess = has?.({ permission: "pro" });`

## كيفية منح مستخدم صلاحيات "Pro" يدويًا (للتجربة)

هذه الطريقة مفيدة جدًا إذا أردت تجربة الميزات المدفوعة بنفسك، أو منحها لمستخدم معين بشكل يدوي.

1.  **اذهب إلى لوحة تحكم Clerk:**
    *   قم بتسجيل الدخول إلى حسابك في [Clerk](https://dashboard.clerk.com/).

2.  **اذهب إلى قسم الأدوار (Roles):**
    *   من القائمة الجانبية، اختر **Roles**.

3.  **إنشاء دور جديد:**
    *   اضغط على زر **Create role**.
    *   **اسم الدور (Role name):** أدخل `pro` (يجب أن يكون الاسم مطابقًا تمامًا للكود).
    *   **الأذونات (Permissions):** في حقل الأذونات، اكتب `pro` واضغط على **Create "pro"**. هذا سينشئ إذنًا جديدًا ويربطه بهذا الدور.
    *   اضغط على **Create role** لحفظ الدور الجديد.

4.  **اذهب إلى قسم المستخدمين (Users):**
    *   من القائمة الجانبية، اختر **Users**.

5.  **اختر المستخدم:**
    *   ابحث عن المستخدم الذي تريد منحه الصلاحيات (يمكن أن يكون حسابك الذي تستخدمه للتجربة) واضغط عليه.

6.  **منح الدور للمستخدم:**
    *   في صفحة تفاصيل المستخدم، ابحث عن قسم **Roles**.
    *   اضغط على **Manage roles**.
    *   ستظهر قائمة بالأدوار المتاحة. اختر دور `pro` الذي أنشأته للتو.
    *   اضغط على **Save** لحفظ التغييرات.

**وهكذا!** الآن، هذا المستخدم لديه صلاحيات "Pro" في موقعك. قد يحتاج المستخدم إلى تسجيل الخروج ثم تسجيل الدخول مرة أخرى لكي تظهر له الصلاحيات الجديدة.

## ملاحظة حول الاشتراكات التلقائية

الطريقة المذكورة أعلاه هي طريقة يدوية. لكي يعمل نظام الاشتراكات بشكل تلقائي (على سبيل المثال، عندما يقوم مستخدم بالدفع عبر Stripe)، ستحتاج إلى ربط Stripe مع Clerk باستخدام "Webhooks". هذه عملية متقدمة تتطلب برمجة إضافية، ولكن الفكرة العامة هي:

1.  عندما يقوم مستخدم بالاشتراك بنجاح في Stripe، يرسل Stripe إشعارًا (Webhook) إلى Clerk.
2.  يقوم Clerk باستلام هذا الإشعار، وبناءً عليه، يقوم تلقائيًا بمنح دور `pro` لهذا المستخدم.

هذا يضمن أن المستخدمين الذين يدفعون يحصلون على الصلاحيات تلقائيًا.

---

آمل أن يكون هذا الشرح واضحًا ومفيدًا. إذا كان لديك أي أسئلة أخرى، فلا تتردد في طرحها!
